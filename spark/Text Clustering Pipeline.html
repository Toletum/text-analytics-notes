<!DOCTYPE html>
<html>
<head>
  <meta name="databricks-html-version" content="1">
<title>Text Clustering Pipeline (1) - Databricks</title>

<meta charset="utf-8">
<meta name="google" content="notranslate">
<meta http-equiv="Content-Language" content="en">
<meta http-equiv="Content-Type" content="text/html; charset=UTF8">
<link rel="stylesheet"
  href="https://fonts.googleapis.com/css?family=Source+Code+Pro:400,700">

<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/201603241449160700-a0929df2de56785ff123ca0f02a6f09beb2a953f/lib/css/bootstrap.min.css">
<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/201603241449160700-a0929df2de56785ff123ca0f02a6f09beb2a953f/lib/jquery-ui-bundle/jquery-ui.min.css">
<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/201603241449160700-a0929df2de56785ff123ca0f02a6f09beb2a953f/css/main.css">
<link rel="stylesheet" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/201603241449160700-a0929df2de56785ff123ca0f02a6f09beb2a953f/css/print.css" media="print">
<link rel="icon" type="image/png" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/201603241449160700-a0929df2de56785ff123ca0f02a6f09beb2a953f/img/favicon.ico"/>
<script>window.settings = {"enableAutoCompleteAsYouType":[],"devTierName":"Community Edition","workspaceFeaturedLinks":[{"linkURI":"https://docs.cloud.databricks.com/docs/latest/databricks_guide/index.html","displayName":"Databricks Guide","icon":"question"},{"linkURI":"https://docs.cloud.databricks.com/docs/latest/sample_applications/index.html","displayName":"Application Examples","icon":"code"},{"linkURI":"https://docs.cloud.databricks.com/docs/latest/courses/index.html","displayName":"Training","icon":"graduation-cap"}],"sparkDocsSearchGoogleCx":"004588677886978090460:_rj0wilqwdm","dbcForumURL":"http://forums.databricks.com/","dbfsS3Host":"https://databricks-prod-storage-oregon.s3.amazonaws.com","nodeInfo":{"node_types":[{"spark_heap_memory":4800,"instance_type_id":"r3.2xlarge","spark_core_oversubscription_factor":3.0,"node_type_id":"dev-tier-node","description":"Community Optimized","container_memory_mb":6000,"memory_mb":6144,"num_cores":0.88}],"default_node_type_id":"dev-tier-node"},"enableThirdPartyApplicationsUI":false,"enableClusterAcls":false,"notebookRevisionVisibilityHorizon":6,"enableTableHandler":true,"isAdmin":true,"enableLargeResultDownload":true,"zoneInfos":[{"id":"us-west-2c","isDefault":true},{"id":"us-west-2b","isDefault":false},{"id":"us-west-2a","isDefault":false}],"nameAndEmail":"César de Pablo Sanchez (zesar.depablo@gmail.com)","enablePublishNotebooks":true,"enableFullTextSearch":false,"enableElasticSparkUI":false,"clusters":true,"allowRunOnPendingClusters":true,"hideOffHeapCache":false,"applications":false,"useStaticGuide":true,"fileStoreBase":"FileStore","configurableSparkOptionsSpec":[{"keyPattern":"spark\\.kryo(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.kryo.*","valuePatternDisplay":"*","description":"Configuration options for Kryo serialization"},{"keyPattern":"spark\\.io\\.compression\\.codec","valuePattern":"(lzf|snappy|org\\.apache\\.spark\\.io\\.LZFCompressionCodec|org\\.apache\\.spark\\.io\\.SnappyCompressionCodec)","keyPatternDisplay":"spark.io.compression.codec","valuePatternDisplay":"snappy|lzf","description":"The codec used to compress internal data such as RDD partitions, broadcast variables and shuffle outputs."},{"keyPattern":"spark\\.serializer","valuePattern":"(org\\.apache\\.spark\\.serializer\\.JavaSerializer|org\\.apache\\.spark\\.serializer\\.KryoSerializer)","keyPatternDisplay":"spark.serializer","valuePatternDisplay":"org.apache.spark.serializer.JavaSerializer|org.apache.spark.serializer.KryoSerializer","description":"Class to use for serializing objects that will be sent over the network or need to be cached in serialized form."},{"keyPattern":"spark\\.rdd\\.compress","valuePattern":"(true|false)","keyPatternDisplay":"spark.rdd.compress","valuePatternDisplay":"true|false","description":"Whether to compress serialized RDD partitions (e.g. for StorageLevel.MEMORY_ONLY_SER). Can save substantial space at the cost of some extra CPU time."},{"keyPattern":"spark\\.speculation","valuePattern":"(true|false)","keyPatternDisplay":"spark.speculation","valuePatternDisplay":"true|false","description":"Whether to use speculation (recommended off for streaming)"},{"keyPattern":"spark\\.es(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"es(\\.([^\\.]+))+","valuePattern":".*","keyPatternDisplay":"es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"spark\\.(storage|shuffle)\\.memoryFraction","valuePattern":"0?\\.0*([1-9])([0-9])*","keyPatternDisplay":"spark.(storage|shuffle).memoryFraction","valuePatternDisplay":"(0.0,1.0)","description":"Fraction of Java heap to use for Spark's shuffle or storage"},{"keyPattern":"spark\\.streaming\\.backpressure\\.enabled","valuePattern":"(true|false)","keyPatternDisplay":"spark.streaming.backpressure.enabled","valuePatternDisplay":"true|false","description":"Enables or disables Spark Streaming's internal backpressure mechanism (since 1.5). This enables the Spark Streaming to control the receiving rate based on the current batch scheduling delays and processing times so that the system receives only as fast as the system can process. Internally, this dynamically sets the maximum receiving rate of receivers. This rate is upper bounded by the values `spark.streaming.receiver.maxRate` and `spark.streaming.kafka.maxRatePerPartition` if they are set."},{"keyPattern":"spark\\.streaming\\.receiver\\.maxRate","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.receiver.maxRate","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which each receiver will receive data. Effectively, each stream will consume at most this number of records per second. Setting this configuration to 0 or a negative number will put no limit on the rate. See the deployment guide in the Spark Streaming programing guide for mode details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRatePerPartition","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRatePerPartition","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which data will be read from each Kafka partition when using the Kafka direct stream API introduced in Spark 1.3. See the Kafka Integration guide for more details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRetries","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRetries","valuePatternDisplay":"numeric","description":"Maximum number of consecutive retries the driver will make in order to find the latest offsets on the leader of each partition (a default value of 1 means that the driver will make a maximum of 2 attempts). Only applies to the Kafka direct stream API introduced in Spark 1.3."},{"keyPattern":"spark\\.streaming\\.ui\\.retainedBatches","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.ui.retainedBatches","valuePatternDisplay":"numeric","description":"How many batches the Spark Streaming UI and status APIs remember before garbage collecting."}],"enableReactNotebookComments":true,"enableResetPassword":true,"enableJobsSparkUpgrade":true,"sparkVersions":[{"key":"1.3.x-ubuntu15.10","displayName":"Spark 1.3.0 (Hadoop 1)","packageLabel":"spark-1.3-jenkins-ip-10-30-10-144-Ua0929df2de-Sa2ee4664b2-2016-03-24-22:00:06.332934","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.4.x-ubuntu15.10","displayName":"Spark 1.4.1 (Hadoop 1)","packageLabel":"spark-1.4-jenkins-ip-10-30-10-144-Ua0929df2de-S9c254ab12a-2016-03-24-22:00:06.332934","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.5.x-ubuntu15.10","displayName":"Spark 1.5.2 (Hadoop 1)","packageLabel":"spark-1.5-jenkins-ip-10-30-10-144-Ua0929df2de-S9ca52d000d-2016-03-24-22:00:06.332934","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.0-ubuntu15.10","displayName":"Spark 1.6.0 (Hadoop 1)","packageLabel":"spark-1.6.0-jenkins-ip-10-30-10-144-Ua0929df2de-Sf90f83597b-2016-03-24-22:00:06.332934","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.1-ubuntu15.10-hadoop1","displayName":"Spark 1.6.1 (Hadoop 1)","packageLabel":"spark-1.6.1-hadoop1-jenkins-ip-10-30-10-144-Ua0929df2de-S91a12bb288-2016-03-24-22:00:06.332934","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.1-ubuntu15.10-hadoop2","displayName":"Spark 1.6.1 (Hadoop 2)","packageLabel":"spark-1.6.1-hadoop2-jenkins-ip-10-30-10-144-Ua0929df2de-S91a12bb288-2016-03-24-22:00:06.332934","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.x-ubuntu15.10","displayName":"Spark 1.6.x (Hadoop 1)","packageLabel":"spark-1.6.1-hadoop1-jenkins-ip-10-30-10-144-Ua0929df2de-S91a12bb288-2016-03-24-22:00:06.332934","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"1.6.x-ubuntu15.10-hadoop1","displayName":"Spark 1.6.x (Hadoop 1)","packageLabel":"spark-1.6.1-hadoop1-jenkins-ip-10-30-10-144-Ua0929df2de-S91a12bb288-2016-03-24-22:00:06.332934","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"1.6.x-ubuntu15.10-hadoop2","displayName":"Spark 1.6.x (Hadoop 2)","packageLabel":"spark-1.6.1-hadoop2-jenkins-ip-10-30-10-144-Ua0929df2de-S91a12bb288-2016-03-24-22:00:06.332934","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"master","displayName":"Spark master (dev)","packageLabel":"","upgradable":true,"deprecated":false,"customerVisible":false}],"enableRestrictedClusterCreation":true,"enableFeedback":true,"defaultNumWorkers":0,"defaultZoneId":"us-west-2c","serverContinuationTimeoutMillis":10000,"driverStderrFilePrefix":"stderr","enableNotebookRefresh":false,"driverStdoutFilePrefix":"stdout","enableSparkDocsSearch":true,"prefetchSidebarNodes":true,"sparkHistoryServerEnabled":true,"sanitizeMarkdownHtml":true,"enableIPythonImportExport":true,"enableNotebookHistoryDiffing":true,"branch":"2.15.2","accountsLimit":3,"enableNotebookGitBranching":true,"local":false,"enableStrongPassword":false,"displayDefaultContainerMemoryGB":6,"devTierHomepageDesign":"featured-notebooks","deploymentMode":"production","useSpotForWorkers":true,"enableUserInviteWorkflow":true,"enableStaticNotebooks":true,"dbcGuideURL":"#workspace/databricks_guide/00 Welcome to Databricks","enableCssTransitions":true,"showHomepageFeaturedLinks":true,"pricingURL":"https://databricks.com/product/pricing","enableClusterAclsConfig":false,"orgId":1849667666963343,"enableNotebookGitVersioning":true,"files":"files/","enableAutoScaledClusterSelection":false,"enableDriverLogsUI":true,"disableLegacyDashboards":true,"enableWorkspaceAclsConfig":false,"dropzoneMaxFileSize":4096,"enableNewDashboardViews":true,"driverLog4jFilePrefix":"log4j","enableMavenLibraries":true,"displayRowLimit":1000,"defaultSparkVersion":{"key":"1.6.0-ubuntu15.10","displayName":"Spark 1.6.0 (Hadoop 1)","packageLabel":"spark-1.6.0-jenkins-ip-10-30-10-144-Ua0929df2de-Sf90f83597b-2016-03-24-22:00:06.332934","upgradable":true,"deprecated":false,"customerVisible":true},"enableMountAclsConfig":false,"clusterPublisherRootId":555452184454234,"enableLatestJobRunResultPermalink":true,"disallowAddingAdmins":true,"enableSparkConfUI":true,"enableOrgSwitcherUI":true,"clustersLimit":1,"enableJdbcImport":true,"logfiles":"logfiles/","enableWebappSharding":false,"enableClusterDeltaUpdates":true,"csrfToken":"8ae5a879-3353-46c8-8760-30857d205436","useFixedStaticNotebookVersionForDevelopment":false,"enableMountAcls":false,"requireEmailUserName":true,"enableDashboardViews":false,"dbcFeedbackURL":"mailto:feedback@databricks.com","enableMountAclService":true,"enableWorkspaceAclService":true,"someName":"César de Pablo Sanchez","enableWorkspaceAcls":false,"gitHash":"a0929df2de56785ff123ca0f02a6f09beb2a953f","showWorkspaceFeaturedLinks":true,"userFullname":"César de Pablo Sanchez","allowFeedbackForumAccess":true,"enableImportFromUrl":true,"enableMiniClusters":true,"enableWebSocketDeltaUpdates":true,"showDevTierBetaVersion":true,"enableDebugUI":false,"showHiddenSparkVersions":false,"allowNonAdminUsers":true,"userId":1701654016298032,"dbcSupportURL":"","staticNotebookResourceUrl":"https://databricks-prod-cloudfront.cloud.databricks.com/static/201603241449160700-a0929df2de56785ff123ca0f02a6f09beb2a953f/","enableSparkPackages":true,"enableHybridClusterType":false,"enableNotebookHistoryUI":true,"availableWorkspaces":[{"name":"Synergic Partners","needsConfirmation":false,"orgId":1849667666963343,"owner":"zesar.depablo@gmail.com"}],"enableFolderHtmlExport":true,"enableSparkVersionsUI":true,"homepageFeaturedLinks":[{"linkURI":"https://docs.cloud.databricks.com/docs/latest/featured_notebooks/1%20QuickStart%20Notebooks%20(Python).html","displayName":"Getting Started","icon":"img/home/Python_icon.svg"},{"linkURI":"https://docs.cloud.databricks.com/docs/latest/featured_notebooks/3%20QuickStart%20DataFrames%20(Scala).html","displayName":"Introduction to DataFrames","icon":"img/home/Scala_icon.svg"},{"linkURI":"https://docs.cloud.databricks.com/docs/latest/featured_notebooks/DecisionTrees-Example.html","displayName":"Decision Trees in Spark","icon":"img/home/Scala_icon.svg"}],"databricksGuideStaticUrl":"https://docs.cloud.databricks.com/docs/latest/databricks_guide","enableHybridClusters":true,"upgradeURL":"https://accounts.cloud.databricks.com/registration.html","clusterManagerAclsEnabled":false,"notebookLoadingBackground":"#fff","enableNewJobRunDetailsPage":true,"user":"zesar.depablo@gmail.com","enableServerAutoComplete":true,"enableStaticHtmlImport":true,"defaultMemoryPerContainerMB":6000,"enablePresenceUI":true,"tablesPublisherRootId":555452184454233,"enableNewInputWidgetUI":false,"accounts":true,"useFramedStaticNotebooks":true,"enableNewProgressReportUI":true,"defaultCoresPerContainer":4};</script>
<script>var __DATABRICKS_NOTEBOOK_MODEL = {"version":"NotebookV1","origId":1547858325535991,"name":"Text Clustering Pipeline (1)","language":"scala","commands":[{"version":"CommandV1","origId":1547858325535993,"guid":"28e94ae6-a0be-4b66-82e4-0d9788bb5c1a","subtype":"command","commandType":"auto","position":1.0,"command":"val training = sqlContext.read.parquet(\"/databricks-datasets/news20.binary/data-001/training\").cache()\nval test = sqlContext.read.parquet(\"/databricks-datasets/news20.binary/data-001/test\").cache()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">training: org.apache.spark.sql.DataFrame = [id: string, text: string, topic: string, label: double]\ntest: org.apache.spark.sql.DataFrame = [id: string, text: string, topic: string, label: double]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:35: error: not found: value training\nval $ires0 = training\n             ^\n&lt;console&gt;:36: error: package test is not a value\nval $ires1 = test\n             ^\n&lt;console&gt;:30: error: not found: value training\n       training = sqlContext.read.parquet(&quot;/databricks-datasets/news20.binary/data-001/training&quot;).cache()\n       ^\n&lt;console&gt;:31: error: package test is not a value\n       test = sqlContext.read.parquet(&quot;/databricks-datasets/news20.binary/data-001/test&quot;).cache()\n       ^\n</div>","error":null,"workflows":[],"startTime":1.459287266196E12,"submitTime":1.459287238931E12,"finishTime":1.459287268402E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"zesar.depablo@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"589e85f5-7aca-496a-88a6-6966d0927e57"},{"version":"CommandV1","origId":1547858325535994,"guid":"639adce1-694e-48ef-b00e-ed051b32a953","subtype":"command","commandType":"auto","position":2.0,"command":"import org.apache.spark.ml.feature._\nimport org.apache.spark.ml.clustering.KMeans\n\n\nval tokenizer = new RegexTokenizer().setInputCol(\"text\").setOutputCol(\"words\").setPattern(\"\\\\s+\")\nval stop = new StopWordsRemover().setInputCol(\"words\").setOutputCol(\"filteredWords\")\nval tf = new CountVectorizer().setInputCol(\"filteredWords\").setOutputCol(\"rawFeatures\").setVocabSize(10000).setMinDF(2)\nval idf = new IDF().setInputCol(\"rawFeatures\").setOutputCol(\"idfFeatures\")\nval normalizer = new Normalizer().setInputCol(\"idfFeatures\").setOutputCol(\"features\")\nval kmeans = new KMeans().setK(20).setMaxIter(100)\n","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">import org.apache.spark.ml.feature._\nimport org.apache.spark.ml.clustering.KMeans\ntokenizer: org.apache.spark.ml.feature.RegexTokenizer = regexTok_a8df9981e299\nstop: org.apache.spark.ml.feature.StopWordsRemover = stopWords_3d749217fc61\ntf: org.apache.spark.ml.feature.CountVectorizer = cntVec_a85fa636c820\nidf: org.apache.spark.ml.feature.IDF = idf_478526a7f839\nnormalizer: org.apache.spark.ml.feature.Normalizer = normalizer_920d56e47698\nkmeans: org.apache.spark.ml.clustering.KMeans = kmeans_fc1c2e4bc753\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:75: error: value setInputtCol is not a member of org.apache.spark.ml.feature.StopWordsRemover\n       val stop = new StopWordsRemover().setInputtCol(&quot;words&quot;).setOutputCol(&quot;filteredWords&quot;)\n                                         ^\n</div>","error":null,"workflows":[],"startTime":1.459291615122E12,"submitTime":1.459291587669E12,"finishTime":1.459291615279E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"zesar.depablo@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"06dec402-d41e-4594-b8cd-bfea9d648f32"},{"version":"CommandV1","origId":1547858325535995,"guid":"55cedfcf-c193-45e1-804e-2795e40f47be","subtype":"command","commandType":"auto","position":3.0,"command":"kmeans.explainParams()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res24: String = \nfeaturesCol: features column name (default: features)\ninitMode: initialization algorithm (default: k-means||)\ninitSteps: number of steps for k-means|| (default: 5)\nk: number of clusters to create (default: 2, current: 20)\nmaxIter: maximum number of iterations (&gt;= 0) (default: 20, current: 15)\npredictionCol: prediction column name (default: prediction)\nseed: random seed (default: -1689246527)\ntol: the convergence tolerance for iterative algorithms (default: 1.0E-4)\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:42: error: value explainParams is not a member of org.apache.spark.mllib.clustering.KMeans\n              kmeans.explainParams()\n                     ^\n</div>","error":null,"workflows":[],"startTime":1.459289957991E12,"submitTime":1.45928993049E12,"finishTime":1.459289958182E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"zesar.depablo@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"e639121a-be3a-4433-94d1-cdf2d3065283"},{"version":"CommandV1","origId":1547858325535997,"guid":"30e84892-9323-4bf7-bb79-88767d7bd323","subtype":"command","commandType":"auto","position":5.0,"command":"import org.apache.spark.ml.Pipeline\nimport org.apache.spark.ml.PipelineStage\n\n\nval stages: Array[PipelineStage] = Array(tokenizer, stop, tf, idf, normalizer, kmeans)\nval pipeline = new Pipeline().setStages(stages)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">import org.apache.spark.ml.Pipeline\nimport org.apache.spark.ml.PipelineStage\nstages: Array[org.apache.spark.ml.PipelineStage] = Array(regexTok_a8df9981e299, stopWords_3d749217fc61, cntVec_a85fa636c820, idf_478526a7f839, normalizer_920d56e47698, kmeans_fc1c2e4bc753)\npipeline: org.apache.spark.ml.Pipeline = pipeline_363c8395b9a4\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.459291625839E12,"submitTime":1.45929159838E12,"finishTime":1.459291626167E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"zesar.depablo@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"56897f85-91c8-49c2-8aa7-daeb7bf2ffd9"},{"version":"CommandV1","origId":1547858325535998,"guid":"25a2f484-b1ef-4705-8d6d-c95b29b5916d","subtype":"command","commandType":"auto","position":6.0,"command":"val model = pipeline.fit(training)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">model: org.apache.spark.ml.PipelineModel = pipeline_363c8395b9a4\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"java.lang.IllegalArgumentException: Field \"idfFeatures\" does not exist.","error":"<div class=\"ansiout\">\tat org.apache.spark.sql.types.StructType$$anonfun$apply$1.apply(StructType.scala:212)\n\tat org.apache.spark.sql.types.StructType$$anonfun$apply$1.apply(StructType.scala:212)\n\tat scala.collection.MapLike$class.getOrElse(MapLike.scala:128)\n\tat scala.collection.AbstractMap.getOrElse(Map.scala:58)\n\tat org.apache.spark.sql.types.StructType.apply(StructType.scala:211)\n\tat org.apache.spark.ml.UnaryTransformer.transformSchema(Transformer.scala:106)\n\tat org.apache.spark.ml.Pipeline$$anonfun$transformSchema$4.apply(Pipeline.scala:173)\n\tat org.apache.spark.ml.Pipeline$$anonfun$transformSchema$4.apply(Pipeline.scala:173)\n\tat scala.collection.IndexedSeqOptimized$class.foldl(IndexedSeqOptimized.scala:51)\n\tat scala.collection.IndexedSeqOptimized$class.foldLeft(IndexedSeqOptimized.scala:60)\n\tat scala.collection.mutable.ArrayOps$ofRef.foldLeft(ArrayOps.scala:108)\n\tat org.apache.spark.ml.Pipeline.transformSchema(Pipeline.scala:173)\n\tat org.apache.spark.ml.PipelineStage.transformSchema(Pipeline.scala:68)\n\tat org.apache.spark.ml.Pipeline.fit(Pipeline.scala:127)</div>","workflows":[],"startTime":1.459291631898E12,"submitTime":1.459291604442E12,"finishTime":1.459291777279E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"zesar.depablo@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"a04a0ac3-b3f1-4371-944c-d4edf85c6a74"},{"version":"CommandV1","origId":1547858325536000,"guid":"750bda13-8ca2-418d-8c15-e8c3d781e198","subtype":"command","commandType":"auto","position":7.5,"command":"transformedTest.printSchema()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">root\n |-- id: string (nullable = true)\n |-- text: string (nullable = true)\n |-- topic: string (nullable = true)\n |-- label: double (nullable = true)\n |-- words: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- rawFeatures: vector (nullable = true)\n |-- features: vector (nullable = true)\n |-- prediction: integer (nullable = true)\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.459288043559E12,"submitTime":1.459288016257E12,"finishTime":1.459288043637E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"zesar.depablo@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"0830afed-2d83-438f-8f8a-c19b9954cadf"},{"version":"CommandV1","origId":1547858325536012,"guid":"105a8436-42ad-48ba-be1e-dfd32432ac8c","subtype":"command","commandType":"auto","position":8.5,"command":"val transformedTrain = model.transform(training)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">transformedTrain: org.apache.spark.sql.DataFrame = [id: string, text: string, topic: string, label: double, words: array&lt;string&gt;, filteredWords: array&lt;string&gt;, rawFeatures: vector, idfFeatures: vector, features: vector, prediction: int]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:64: error: not found: value train\n       val transformedTrain = model.transform(train)\n                                              ^\n</div>","error":null,"workflows":[],"startTime":1.459291829476E12,"submitTime":1.459291802003E12,"finishTime":1.459291829651E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"zesar.depablo@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"d386dc5c-77cd-4177-a34f-bd66f0af6b30"},{"version":"CommandV1","origId":1547858325536013,"guid":"be097763-d5ad-437d-8377-817b91e4e852","subtype":"command","commandType":"auto","position":8.75,"command":"display(transformedTrain.groupBy(\"prediction\").count())","commandVersion":0,"state":"finished","results":{"type":"table","data":[[0.0,3.0],[1.0,56.0],[2.0,186.0],[3.0,110.0],[4.0,94.0],[5.0,947.0],[6.0,6.0],[7.0,11.0],[8.0,182.0],[9.0,344.0],[10.0,650.0],[11.0,51.0],[12.0,18.0],[13.0,6.0],[14.0,5.0],[15.0,2.0],[16.0,74.0],[17.0,353.0],[18.0,596.0],[19.0,7620.0]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"prediction","type":"\"integer\""},{"name":"count","type":"\"long\""}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":null,"error":null,"workflows":[],"startTime":1.45929183498E12,"submitTime":1.45929180751E12,"finishTime":1.459291841508E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"zesar.depablo@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"1f39d3f9-f7d1-4ad7-ac42-fa20bbf885c5"},{"version":"CommandV1","origId":1547858325536016,"guid":"6b433fa3-dd8a-4ae9-9d52-7c90ddbb4fb7","subtype":"command","commandType":"auto","position":10.75,"command":"import org.apache.spark.ml.clustering.KMeansModel\nval stage = model.stages(4)\n\nstage.asInstanceOf[KMeansModel].clusterCenters.foreach(println)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">[2.4922224414041176,0.0,0.0,0.0033709788003224495,0.040678111755787415,1.6574904680078635,1.0680574728833707,0.28915368000088126,0.5544033588881522,0.4554181179984231,0.6253384788555417,0.47938618377118236,0.5748349978046814,0.5510168437639957,0.546437964221288,0.3416935309384325,0.6534166125657971,0.3633719259956767,1.0650328832632636,0.45351552172212584,0.48877475098123474,0.9199266155509851,0.9595277618726673,0.5188926834570413,0.49033079530938656,0.5469412667069192,0.5246548223528243,0.4878800128842931,0.4755716528574762,0.44704704861806627,0.0,0.4654608396898213,0.4177626871052103,0.3347103585317289,0.4025725678339813,0.357220867824216,0.37214119729846645,0.38540227484637046,0.3789466617432506,0.3615824628523964,0.37957957702536355,0.36815155130790833,0.30990282440172834,0.35917246987469204,0.33346782873430286,0.3468002524835282,0.32696843211537185,0.3496207549789261,0.34627386014594225,0.3378657507288945,0.34549823184028927,0.34915050807761694,0.2824243192703276,0.3154835871882131,0.32624952528600587,0.3020422649226033,0.314714103579761,0.4145667470230283,0.3033082520293556,0.3154239757344756,0.3392620810808862,0.44863520652366384,0.27660869199930616,0.3072408394239028,0.32346217421723134,0.3913609038342509,0.3070380214027638,0.30340667513640557,0.26992193607456877,0.26553208113154547,0.28124676527443654,0.2920267706261836,0.27092955474662406,0.2837064397055055,0.3396093954598934,0.2658616905381002,0.28538343595114296,0.3775560592838733,0.278747042232169,0.26721910918400293,0.4705370512309851,0.27841185203021185,0.27087598213424396,0.28529740830668676,0.25804558613201894,0.27412643741390347,0.26511112091232486,0.33645876166701516,0.2718224710139804,0.2622717091560457,0.3057385030704025,0.2683147483327689,0.26125378698384505,0.2910697646253972,0.31514524030005037,0.24592540756277076,0.25499641970599135,0.2401760382473407,0.27233229450275614,0.2767671094498435,0.2455165927221374,0.2716611743537291,0.2580364210588605,0.2493564190488258,0.290579275404686,0.23582244435903676,0.23547497935026837,0.24196608053161348,0.26357832502585565,0.24616715552060472,0.23350247234338592,0.23589675319432724,0.24954398335697428,0.22897197712976522,0.23164392691877558,0.3042648563157949,0.2333287342828841,0.22504176919300653,0.318906672452036,0.23427497042037773,0.2259478656237714,0.24612845354225008,0.21875136345383522,0.240804365010197,0.23040767423498676,0.22269195282411988,0.25461362560157896,0.2215541912495583,0.2715756892698923,0.22931627179306507,0.24269352854985352,0.19329061024542507,0.22846035522568753,0.20894201468603898,0.23566525352235584,0.21484294556935965,0.2279148752126911,0.22477859592708477,0.2432919542324384,0.20811022939474044,0.2170635519339265,0.21446917325932843,0.24504914129946032,0.2137686045771239,0.20770860417755474,0.21610248774824958,0.19454740311351423,0.20545179866014024,0.2162591371640095,0.19614885881506539,0.2330861252861869,0.22955286389241958,0.21707828709712315,0.20999001140053322,0.24503038384480277,0.2242626947153789,0.21576609049734852,0.20000426416269648,0.18887321248899344,0.2028072888072,0.20727854903101886,0.20687885120019295,0.20849336337034088,0.20337920883204177,0.1960167654551251,0.3477946415658628,0.2512254725013898,0.20461529650942062,0.18766921540554826,0.20165723966050175,0.1993424796672212,0.20082388054590272,0.1532253302889063,0.26078291774169027,0.21032115932701276,0.19855872029036384,0.22836362087025294,0.20274904513906528,0.20730482912761583,0.19694946973829333,0.19740916065326855,0.2026942276590552,0.19665089073241354,0.20115844129792793,0.197125745141595,0.19869871322548902,0.1992274868832494,0.18803652674802998,0.1940134832312321,0.20510526111221414,0.1951897416409846,0.2160797877894272,0.25413863723411406,0.18494656054832678,0.19652541676167334,0.18766301937809396,0.19274226204041203,0.1972860818803599,0.1861882474735218,0.18137450157962473,0.2060118580547196,0.19731029746344392,0.19857949402527522,0.1685278649537167,0.2503105731123505,0.1933299092373967,0.2062938274922793,0.1105709352197092,0.16304634866145415,0.1992569013359144,0.19507007907182505,0.1970316608620585,0.21631225884867192,0.19522219133947585,0.20497636312772147,0.1759823032781935,0.18129703153297813,0.18187397443355424,0.18974029741270743,0.1833572781938721,0.17894282339320952,0.18293009343014416,0.19394631743000998,0.19175653723786243,0.18926953019264023,0.18101834223913738,0.20246212676572498,0.18535492536731404,0.18671286830626785,0.1919074908685841,0.19297687456031892,0.1939229815213828,0.1811605822718084,0.1815810252530233,0.2633719217568773,0.17450360747813876,0.18051488870693727,0.19381615522834345,0.1105709352197092,0.16997603878740883,0.17045033513699182,0.16994897993895608,0.16932037838782607,0.16546738591990592,0.17402950968110245,0.19243482096783115,0.1785798133302932,0.17266781233246453,0.15527599512779583,0.15477145385702956,0.16993363776084866,0.17268352336669662,0.174444749994863,0.18448328875205497,0.1645574764050077,0.2287706130285587,0.19124458382636245,0.1789293367723731,0.16689078765978355,0.17093594684122357,0.17407532155262198,0.06701268801194496,0.16653696481309338,0.17368619806810923,0.19473572121296023,0.1763137766712593,0.22969297201940111,0.16347748913926588,0.16627936548906214,0.17160626912519322,0.17030574954760394,0.18952794993849192,0.16941388288843845,0.17204017209165354,0.16151114238872047,0.17970585040955422,0.17426032658001023,0.16087378531965726,0.16303448456748545,0.16822545872652517,0.20389871412814387,0.15899502832061768,0.14710019763280396,0.15183006143823363,0.16551701441429922,0.16129801890223558,0.09208328765105735,0.1844284689907745,0.16058300875942053,0.1542778983355382,0.172542544910302,0.23420088918053247,0.1706505279579679,0.15642792983317425,0.19243604917094168,0.2211233417492117,0.163011609254829,0.18090463013422192,0.1537032892652067,0.14655204515797499,0.14944540009195517,0.1825688874321793,0.15596614681098794,0.1562516508312033,0.1623187550826415,0.14379500362771164,0.18503401006247755,0.1561320082694548,0.18880977817111702,0.1574279623758624,0.15966024913449128,0.14593571322908694,0.14353850887950018,0.1674020984165633,0.13980339837353595,0.1492346855235871,0.2552925416298221,0.15204089718148356,0.15647144574454605,0.15853439146347195,0.14465995713012814,0.1528995884220024,0.01090936969798012,0.15236830451372302,0.15205807246020675,0.15247027263373242,0.1608126404817302,0.15121862270777672,0.15481342014290878,0.1493691173252465,0.152535769764486,0.15645682144497383,0.1644628207365429,0.15246553566081672,0.15683104381242052,0.1425148989745308,0.14965691909273252,0.14627254563368577,0.14069073311638308,0.1497285663061851,0.1520561469629305,0.15757185870323143,0.14721344459930366,0.17490824260267307,0.1438849387217608,0.16878447050734122,0.13997339401562106,0.15064801469148112,0.15588748972753916,0.1481442327054218,0.1794761248622667,0.14524039444478581,0.15186994501883902,0.1562357784553887,0.14213094797795298,0.14996557165526062,0.14690086369882827,0.15610700459961913,0.14606222951776865,0.15052019571831812,0.1470723030675238,0.14681573776172072,0.16195915456690407,0.1494681631127796,0.1635158538504287,0.14781721809923806,0.14245869565053645,0.1591586315466211,0.14668728928297814,0.14437507307271613,0.1355232628237104,0.14658768186497279,0.14867095411505862,0.14750850610320132,0.14335645227016716,0.14308899251586624,0.14074179012344523,0.14655748907300165,0.1662929693057571,0.13677837804017443,0.1378256024050625,0.1542913626607575,0.15930484401271006,0.14657629091915067,0.15578703380718648,0.14907306370670678,0.2599239671697158,0.26119732726265676,0.14248912801573335,0.1484082379807484,0.1609822924182837,0.13065927896997537,0.14622343769641907,0.13486036372657226,0.14035930946279263,0.16990096454301326,0.13895751601917056,0.16324907487273876,0.15019969093159558,0.1496299287109474,0.1480778737573044,0.13637214441563397,0.14388210869663118,0.14166835333858838,0.13124630514335012,0.1754664288383441,0.1427052977687561,0.1263098756505986,0.15963025128889788,0.13356460312395652,0.15185099965002158,0.13506630252718,0.11331327041392499,0.13773654878184474,0.14583704122653426,0.14306126373486222,0.15482960650827357,0.13536173004791907,0.1386444302215932,0.13629020008106973,0.13729244762125659,0.15131079440993403,0.13269342896757144,0.13655262556520814,0.146065973784836,0.13478079655090872,0.11951966006441048,0.13755622365985726,0.12497064291718503,0.1369068369931573,0.1292993991487429,0.12205845336818767,0.1314729874150802,0.1333611660814409,0.13022489219021677,0.1421789614557527,0.13909065132011775,0.13480512417746254,0.1328976538728408,0.13387615117813367,0.13746012313652672,0.13766535895479842,0.1411057800435318,0.12849233075186636,0.1311538994440571,0.12981156539534788,0.13875619396821962,0.12738842561970504,0.1309523536743173,0.14905562838232697,0.12548274590546024,0.14183531515501727,0.1289519250279906,0.12726337998795384,0.1287369234976719,0.1291969231263096,0.16451272676530676,0.13718480239501263,0.1259939556161733,0.15758551440249108,0.12607531522902893,0.13379652835405298,0.12395652884654236,0.16435141328012617,0.12215751744210375,0.1350906042096695,0.14134298965031902,0.1281934840579611,0.13754294584040772,0.12982298602519707,0.13999919416931733,0.1307936591312126,0.1491755170273055,0.13576682523019767,0.1311073129900405,0.13838690283918262,0.12841661885823885,0.1433771933405645,0.12430722698685602,0.12346063896346758,0.12713954355111332,0.13129525221074537,0.1299155291875013,0.12051009277503286,0.12148499304175626,0.11624122944978303,0.14050155573588993,0.14361719124274458,0.12472799982278639,0.13845736309469267,0.12776607044743607,0.12747639601354857,0.12336697631744765,0.12427457919365062,0.11618367215182572,0.11856115863692653,0.11803193122403187,0.1653597654782773,0.1313823764291246,0.1327688306927078,0.13973531769345546,0.13944766453543522,0.1236728095398953,0.12304841962496375,0.11335292771570393,0.1291267177926277,0.1268194383661853,0.13363999947306818,0.13696862160541387,0.1114772669045703,0.13316925641465607,0.1156013229619734,0.12219437599973969,0.13191931963056328,0.12134391185624455,0.13581642016185472,0.12851995569195004,0.12058713494475212,0.1291267177926277,0.1110799944156416,0.11438505347293115,0.11831132600874865,0.1256522189927742,0.11704896941708418,0.12138404336637722,0.13313362667717615,0.1448932045946754,0.11254360341273757,0.1331222574957711,0.12805065241999705,0.13060656923637115,0.12050503145020024,0.11948670488694452,0.12238257620541917,0.12192100359340748,0.13063317171647607,0.1297235080398679,0.11784295742784757,0.13244132523236565,0.12347968761349949,0.1357713257746387,0.13316990927167835,0.11454461196098666,0.12271657647644255,0.12392236490726653,0.12927755098150437,0.11586306118110036,0.11780905679880067,0.09305586582256385,0.11718418339865931,0.12262464515791945,0.12770042099486362,0.12133100244581763,0.11942171079219716,0.12793444063026732,0.11512948871733625,0.1133815699811981,0.12898200569123625,0.12854738110434366,0.14568730765358182,0.11819846894782832,0.1208511194540556,0.12112285470402123,0.11450765802330266,0.11764130674319134,0.11866109655211476,0.11490980200870898,0.11996357518545052,0.11635140391038831,0.11683200954840496,0.12016662164056846,0.11354269689568097,0.1201551344224203,0.11683200954840492,0.12144819943654647,0.12363568610908558,0.15832845164663623,0.12119672691281047,0.08431661759307191,0.12115720885725434,0.1136266591182221,0.11831132600874855,0.11650828711970196,0.12457938394124915,0.117240768103657,0.11426058215938191,0.13207367589591978,0.11236678569940982,0.10963239111492588,0.10872904098646458,0.12626282375883452,0.11645347423241566,0.10917283557928273,0.10765040326435768,0.1184593212332978,0.11647173838473916,0.11345449765631682,0.11322904303685315,0.1133505634442607,0.11311016519654236,0.11250836054102734,0.10816535899365691,0.11778811671380125,0.12813080984220274,0.12274182373002313,0.11843449128390383,0.10936488333141468,0.11820428693352607,0.11011515921823707,0.10700885714271172,0.11867154015984249,0.13488789973994725,0.1023449941325873,0.10819121481852598,0.10955095028840071,0.11650680553089987,0.11170641955628341,0.10807610786754406,0.11088489835493444,0.09992473260871328,0.1192577452228217,0.11340049511032917,0.11700381866730868,0.10892647407483087,0.1083769282911847,0.1113316946595335,0.12733798840353905,0.11840110393924116,0.11468362962858011,0.10348052061579703,0.12402623827279884,0.12011236879101563,0.13076987679033392,0.11598111285651444,0.1105572243998246,0.11623965312626847,0.1090703861017139,0.10932931358810342,0.10009958424228671,0.1231177991672443,0.10749336971304096,0.09575635147998941,0.09477508733117931,0.09692015416628458,0.10652102224301932,0.12316178786516738,0.11690052187525668,0.11326378153851581,0.11166653633347784,0.11052737183151519,0.10945898694204906,0.11902590056437834,0.1094333238094985,0.11650680553090008,0.1241082320193728,0.09701192407719396,0.1071197218947256,0.11203114752010981,0.10676987796453619,0.11681801573219588,0.11754833128398713,0.1169301719279513,0.11167289119849856,0.10586327470306162,0.10837588150064047,0.11145124461178363,0.10278798026546233,0.10585475127229335,0.11278894979217016,0.1056252824060678,0.12402068505141295,0.11901760847944419,0.0,0.11793234153282314,0.0903177332232908,0.10849005207312339,0.11580945064369144,0.102387464704343,0.10214851242393963,0.1079555638269272,0.11099576721203633,0.10490743475660279,0.10796819935259894,0.10796819935259895,0.11780692752320365,0.10070464318246576,0.09992561399025005,0.1302823110341062,0.10159226749605905,0.11786089030462403,0.10500565121593589,0.10716564602489138,0.10494135916965402,0.10351338748961302,0.10786076476343615,0.1028259215875293,0.10630359542242779,0.09379437955279622,0.11673540847696547,0.12203620026433476,0.11296741930153802,0.11679451032675736,0.10090485920803642,0.10579073627248929,0.10150007028760893,0.1088321794008932,0.0998006482320678,0.10546248367951719,0.10254705721323319,0.12052344633921352,0.1024823162368665,0.08983438621383691,0.10272907388094758,0.09745466711361227,0.10391294842444954,0.10356986904645828,0.10171146365186773,0.1171198684445976,0.09763300379411277,0.0969750228264748,0.10331719478513526,0.1044468465217654,0.10195710005160234,0.11410233049736282,0.10438278610490977,0.12872739160994193,0.10583994512515575,0.11635440870732461,0.10167901165524337,0.10473996231974371,0.10123175643480263,0.10697093484127762,0.10467728020891297,0.10146594836494201,0.09914061832381224,0.09981174875297134,0.1008709799507851,0.10392699144112047,0.10940345974580638,0.1112472109432214,0.10137578225367674,0.11040179768796872,0.11689602880422914,0.10665979931330966,0.10178042111492615,0.10473259623558656,0.10572451201151062,0.10459023353065425,0.10145551691738222,0.1068304999850747,0.11019648101951765,0.10460205398893718,0.1052994504790903,0.11469090955567263,0.0953767860783104,0.10149381214323355,0.09837019976940622,0.10434704737932311,0.12729427491025813,0.10268906806241468,0.10734541200863992,0.09765298732845168,0.0948888167932798,0.10282926198885889,0.09852297650263274,0.10062415135571243,0.10294880171706558,0.09778216691506124,0.10072362960283801,0.11939098974557537,0.03796772421356318,0.10081323772096717,0.11336362065042559,0.10035522076387306,0.12105006327480766,0.10142540994146239,0.11371260697384135,0.10185451910035641,0.10178707352275564,0.09304498301682351,0.0999594621366559,0.11458311052199907,0.10376763905221938,0.11845203223551996,0.11872972413057106,0.10540696262560455,0.10248452726743933,0.10480173415011079,0.09755363725867615,0.09985962947361576,0.10479368762764156,0.10715279926834206,0.09972076351380292,0.10222251848457141,0.09418087666946316,0.09914558649005262,0.09714971005155676,0.11104031525553672,0.0966524416738891,0.12557544387377673,0.09787323496614043,0.11126324446855235,0.1056882838846424,0.09440920876631183,0.09542615716454116,0.09520413200873733,0.09004886537285249,0.09931493392370813,0.10838271431098631,0.09780744178579874,0.10101708770830017,0.09207295823948676,0.1028064257935087,0.10041458523943249,0.1025360400099678,0.1003640353383952,0.09673446274846426,0.09328639917492795,0.09465160289239885,0.09751307218663831,0.10752217476808727,0.13207022936100665,0.11148160605331806,0.09695505842722159,0.09733474970901675,0.0912577447662918,0.11848076172113765,0.08945045187314425,0.08356404158562254,0.0943844932557999,0.09996120850626858,0.09721490935152789,0.10939762639918076,0.09798546951178108,0.09538489183008518,0.09791824963008898,0.09171995631513384,0.09703864273158401,0.08985473767504362,0.10864832758822757,0.15560206253434797,0.09596864795871483,0.09582682003073684,0.0941401132447724,0.098339482410324,0.09201982491227714,0.089273035453975,0.12429596929492663,0.10356057982796021,0.11528302215724079,0.09469794774323352,0.099722078343919,0.10605359422587779,0.10258657328768954,0.10106772758893984,0.09796571581371002,0.09845011389858886,0.09935832447793692,0.09449099244312874,0.10080601397809198,0.10211682312598093,0.09997706865812393,0.09316318385172696,0.08680402355112171,0.0964782753708229,0.111866372365434,0.109983031972157,0.08863980852843158,0.0931240291402249,0.08951981198382944,0.09936076646586138,0.10312138855466309,0.09440920876631183,0.09014167422584579,0.09924341167106263,0.08480451766647254,0.09156280647523406,0.08056357076098376,0.0996001994721125,0.09877987775646503,0.1221992602628544,0.0,0.0917370365518897,0.0914194819287337,0.09106790096449023,0.09919738439965448,0.09193608001993013,0.09363761283891948,0.08971080779406,0.09611048441563795,0.10087961923825745,0.08885851884084421,0.09134647485758503,0.0914355258540645,0.10162687567705928,0.08436755829927362,0.10386499608506916,0.07842876283120297,0.1025856859902526,0.09210684645451361,0.09221844511232452,0.09647534621317824,0.09580457553503345,0.09603049546588434,0.09235157374630322,0.09171158739378166,0.08903770960504959,0.0930558658225639,0.09853279364035798,0.11112753253110474,0.09650166575456653,0.09459510683208433,0.09021757198560915,0.08951192161020495,0.09736444392721731,0.09324045860470286,0.09456318594257324,0.09587460801538249,0.08674746114417646,0.0897766858146231,0.09021215504947772,0.0904808166837574,0.0901225713597717,0.09114046210153506,0.0910696291584297,0.08116851642204703,0.08967357804867951,0.09077506590005283,0.09660726428106631,0.08746627431757446,0.08252931128871524,0.09401835769160916,0.10952187030078848,0.08637601647590114,0.09520169235014642,0.09602029637219106,0.0907830485246663,0.09414582224262107,0.06980631596077584,0.0904681451573723,0.1012214868072731,0.08587814264529259,0.09355005150410822,0.09524541560662425,0.09316402112017744,0.08460232455727906,0.08325952801335858,0.08862006549392819,0.10766180780238929,0.09891572644854792,0.08822276444863415,0.08091608780808694,0.0873595967870436,0.028043703160760977,0.09610079872212732,0.09389759608962765,0.08807273635265213,0.0839250740544884,0.08586806486842007,0.08769287704538399,0.09457945225252483,0.11106867021529376,0.10535675395099303,0.09467614550934467,0.09683028335605406,0.09411513176163173,0.08542204176772518,0.09041454352764174,0.08882969097158436,0.0943347228313327,0.0827707184780738,0.0858812312996028,0.0883934540406827,0.08462751411808937,0.0995309357187879,0.08274002041488127,0.093276623762334,0.08791974446883964,0.07969125808099245,0.1053452382685881,0.08878587591826072,0.088401571467993,0.09428335437980448,0.09942849766639328,0.0855055401265333,0.08559706438284648,0.08573185498224459,0.09522790161731531,0.08844556356747207,0.08667713703917673,0.08508946402282012,0.12044190951042993,0.08971540092067556,0.08758469829976682,0.08558535740462116,0.0925333837323552,0.09304076709162232,0.0874784362504102,0.09359753205451268,0.0955374639438368,0.08908130511456795,0.08143953205378468,0.08954926688229065,0.0880523502579545,0.0886711899016027,0.09646443138790588,0.08484776973068298,0.08434690448740174,0.07922448710333851,0.08537612114414404,0.1068639847576738,0.08395318579174156,0.08458440121814353,0.11182721884906446,0.08504113781204256,0.08890188998081858,0.08575736654236271,0.08429316336575872,0.08924398796508214,0.09379437955279621,0.08966132073539351,0.08399219056415974,0.0937340988395199,0.08954926688229072,0.09060549682511451,0.08588123129960284,0.09087975913179996,0.0886610297809569,0.08805826403307306,0.09184854226097375,0.0810404517653761,0.09027189742023219,0.09340997635790771,0.08459848773187818,0.08318190936971338,0.09383814036788114,0.08674274226484832,0.08254183883018311,0.08238331168871295,0.09734015723591292,0.0936761747941533,0.08598714086049367,0.08266068512586774,0.09688241518454191,0.09193343987570915,0.07955857782444718,0.07342617316207536,0.09818824936749643,0.08531847486151116,0.08379631951865645,0.07533004915494347,0.0766786293059151,0.0814902955260784,0.08268435697605314,0.08382701983577776,0.0802851780548676,0.0921547505409141,0.09519316372767268,0.08564934635394682,0.08232232698142761,0.08633134687860904,0.09250522260922639,0.07709665440240004,0.08060970804760861,0.0756033809449032,0.08419236173861344,0.0779973546603831,0.07625384814289252,0.07963013730722741,0.08498760176643655,0.0853426038508214,0.08083494449910579,0.07995083940502035,0.08180642071488886,0.08514036182186267,0.07783666574625382,0.07729314506240191,0.08113288194920962,0.07789513781441271,0.09013244331787945,0.07894298335722727,0.08094134069656697,0.07910284581744273,0.08043953280475763,0.07864844345454963,0.07630593352011156,0.08280287888116501,0.08687341288850427,0.08440439415618205,0.07879275720124587,0.08650277254127908,0.08418566758743888,0.07903883765595093,0.07879275720124584,0.08227842565087555,0.08715830046263555,0.08332381045238588,0.07576777503058811,0.0807970261412266,0.08851433123552101,0.08394890447733232,0.07842876283120297,0.1008531245702058,0.07736672384390555,0.10808404834365644,0.08208682797543318,0.07879697298534007,0.06950465061266385,0.08317216801581544,0.08037727728786576,0.07905102455557235,0.07707323111099021,0.0847017126745398,0.08352072675477709,0.09271888191546217,0.08138478328267383,0.08184905274526401,0.08130652084936638,0.08171370603009023,0.08514036182186269,0.08443997758461534,0.08248028794320175,0.08730174353231167,0.07397838744138872,0.08702442803105606,0.08585236820110462,0.07787334873758477,0.0923170682944211,0.07755874618052197,0.08860603385267476,0.08899671518712048,0.08456399157874099,0.08242256075956264,0.0742576284312765,0.08521774650049875,0.07052088295074804,0.07698969720483445,0.08077170085976998,0.0856026613467719,0.09168462244340106,0.07995083940502035,0.08047933669925102,0.08299595135009169,0.07850097580559115,0.06898299993003047,0.07752596654515011,0.07597966149095726,0.07667862930591512,0.07442357489535265,0.07638269369905575,0.0788700551770871,0.07872132636368936,0.0894862218948464,0.07357087999525644,0.07235112977473837,0.08534260385082136,0.07170629945289787,0.07896073009256237,0.08171163128555502,0.07709665440240004,0.07813922015671745,0.0787845205211318,0.07486776400572374,0.07308613529649848,0.09391138355765463,0.08483198348220401,0.08301162925485975,0.08143942331025704,0.07235756877547343,0.07730585640298615,0.07894472145157999,0.07915968490456571,0.08765930110756064,0.08132252827943326,0.0807324254041801,0.07407937439140126,0.08069596772318817,0.07713203106676524,0.07906842208311081,0.07947497435803298,0.07712443404389807,0.07370935351084286,0.07381910115630248,0.07746219147126863,0.07536538821419188,0.07330722127192234,0.08189828351603491,0.07883555429360105,0.07952668320772693,0.07552577168028073,0.08211006972420264,0.06479268756595606,0.06598981918329419,0.08216195866338924,0.07684213786839046,0.0732552635412435,0.08382440884207361,0.07880169618039032,0.0740285550046485,0.0795806966299971,0.0766375941302697,0.07716221354170531,0.07746232992849307,0.06410281529073321,0.07749787533594192,0.08849418483974433,0.08849691484314486,0.09116950654777767,0.09029283963729128,0.06809302607129586,0.08110907412147537,0.07713203106676525,0.07585129175224323,0.07646294241148593,0.085743985285894,0.07407976769404104,0.07419424293650864,0.07507985254856618,0.08239782736422911,0.0733462532472427,0.0753383544043084,0.0745961046072216,0.07819470863346206,0.08152715685522835,0.07788217173903461,0.07717683303806033,0.07336919592931322,0.07891395831235692,0.07299035318609488,0.0746498850854262,0.07228799046836935,0.07787726808190307,0.07300050650253276,0.074300797567474,0.0717095725537327,0.07580878315583382,0.07128758178147003,0.07593468318404524,0.08197093733756837,0.07352961246626398,0.09208328765105737,0.07826772704467336,0.0749696182977428,0.07415990801910684,0.07521367279570265,0.07417355850088724,0.07188038371191884,0.07843406287727617,0.07665329220597306,0.07455361957576817,0.07134028426883096,0.07343327634228805,0.08618931234731944,0.07051376826870684,0.08041107393432709,0.08022102001559105,0.07408655278817905,0.08771774819974076,0.07298315298364251,0.06739222703778897,0.07327382067328352,0.07509097843913294,0.06700491538814647,0.08518984931118216,0.0771768330380603,0.07985865960987149,0.07636926550095259,0.07452370151378283,0.089945719271... skipped 1185871 bytes ...\nimport org.apache.spark.ml.clustering.KMeansModel\nstage: org.apache.spark.ml.Transformer = kmeans_bcb27e0f9ddd\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:108: error: T0 does not take parameters\n              stage.asInstanceOf(KMeansModel)\n                                ^\n</div>","error":null,"workflows":[],"startTime":1.459291361938E12,"submitTime":1.459291334486E12,"finishTime":1.459291362335E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"zesar.depablo@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"ee617111-fc90-448f-906f-2dbecde5b59f"}],"dashboards":[],"guid":"35ff9dea-c25f-4290-847d-f8595a296066","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}};</script>
<script
 src="https://databricks-prod-cloudfront.cloud.databricks.com/static/201603241449160700-a0929df2de56785ff123ca0f02a6f09beb2a953f/js/notebook-main.js"
 onerror="window.mainJsLoadError = true;"></script>
</head>
<body>
  <script>
if (window.mainJsLoadError) {
  var u = 'https://databricks-prod-cloudfront.cloud.databricks.com/static/201603241449160700-a0929df2de56785ff123ca0f02a6f09beb2a953f/js/notebook-main.js';
  var b = document.getElementsByTagName('body')[0];
  var c = document.createElement('div');
  c.innerHTML = ('<h1>Network Error</h1>' +
    '<p><b>Please check your network connection and try again.</b></p>' +
    '<p>Could not load a required resource: ' + u + '</p>');
  c.style.margin = '30px';
  c.style.padding = '20px 50px';
  c.style.backgroundColor = '#f5f5f5';
  c.style.borderRadius = '5px';
  b.appendChild(c);
}
</script>
</body>
</html>
