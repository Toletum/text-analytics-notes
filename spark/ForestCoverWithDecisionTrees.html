<!DOCTYPE html>
<html>
<head>
  <meta name="databricks-html-version" content="1">
<title>ForestCoverWithDecisionTrees - Databricks</title>

<meta charset="utf-8">
<meta name="google" content="notranslate">
<meta http-equiv="Content-Language" content="en">
<meta http-equiv="Content-Type" content="text/html; charset=UTF8">
<link rel="stylesheet"
  href="https://fonts.googleapis.com/css?family=Source+Code+Pro:400,700">

<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/201603241449160700-a0929df2de56785ff123ca0f02a6f09beb2a953f/lib/css/bootstrap.min.css">
<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/201603241449160700-a0929df2de56785ff123ca0f02a6f09beb2a953f/lib/jquery-ui-bundle/jquery-ui.min.css">
<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/201603241449160700-a0929df2de56785ff123ca0f02a6f09beb2a953f/css/main.css">
<link rel="stylesheet" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/201603241449160700-a0929df2de56785ff123ca0f02a6f09beb2a953f/css/print.css" media="print">
<link rel="icon" type="image/png" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/201603241449160700-a0929df2de56785ff123ca0f02a6f09beb2a953f/img/favicon.ico"/>
<script>window.settings = {"enableAutoCompleteAsYouType":[],"devTierName":"Community Edition","workspaceFeaturedLinks":[{"linkURI":"https://docs.cloud.databricks.com/docs/latest/databricks_guide/index.html","displayName":"Databricks Guide","icon":"question"},{"linkURI":"https://docs.cloud.databricks.com/docs/latest/sample_applications/index.html","displayName":"Application Examples","icon":"code"},{"linkURI":"https://docs.cloud.databricks.com/docs/latest/courses/index.html","displayName":"Training","icon":"graduation-cap"}],"sparkDocsSearchGoogleCx":"004588677886978090460:_rj0wilqwdm","dbcForumURL":"http://forums.databricks.com/","dbfsS3Host":"https://databricks-prod-storage-oregon.s3.amazonaws.com","nodeInfo":{"node_types":[{"spark_heap_memory":4800,"instance_type_id":"r3.2xlarge","spark_core_oversubscription_factor":3.0,"node_type_id":"dev-tier-node","description":"Community Optimized","container_memory_mb":6000,"memory_mb":6144,"num_cores":0.88}],"default_node_type_id":"dev-tier-node"},"enableThirdPartyApplicationsUI":false,"enableClusterAcls":false,"notebookRevisionVisibilityHorizon":6,"enableTableHandler":true,"isAdmin":true,"enableLargeResultDownload":true,"zoneInfos":[{"id":"us-west-2c","isDefault":true},{"id":"us-west-2b","isDefault":false},{"id":"us-west-2a","isDefault":false}],"nameAndEmail":"César de Pablo Sanchez (zesar.depablo@gmail.com)","enablePublishNotebooks":true,"enableFullTextSearch":false,"enableElasticSparkUI":false,"clusters":true,"allowRunOnPendingClusters":true,"hideOffHeapCache":false,"applications":false,"useStaticGuide":true,"fileStoreBase":"FileStore","configurableSparkOptionsSpec":[{"keyPattern":"spark\\.kryo(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.kryo.*","valuePatternDisplay":"*","description":"Configuration options for Kryo serialization"},{"keyPattern":"spark\\.io\\.compression\\.codec","valuePattern":"(lzf|snappy|org\\.apache\\.spark\\.io\\.LZFCompressionCodec|org\\.apache\\.spark\\.io\\.SnappyCompressionCodec)","keyPatternDisplay":"spark.io.compression.codec","valuePatternDisplay":"snappy|lzf","description":"The codec used to compress internal data such as RDD partitions, broadcast variables and shuffle outputs."},{"keyPattern":"spark\\.serializer","valuePattern":"(org\\.apache\\.spark\\.serializer\\.JavaSerializer|org\\.apache\\.spark\\.serializer\\.KryoSerializer)","keyPatternDisplay":"spark.serializer","valuePatternDisplay":"org.apache.spark.serializer.JavaSerializer|org.apache.spark.serializer.KryoSerializer","description":"Class to use for serializing objects that will be sent over the network or need to be cached in serialized form."},{"keyPattern":"spark\\.rdd\\.compress","valuePattern":"(true|false)","keyPatternDisplay":"spark.rdd.compress","valuePatternDisplay":"true|false","description":"Whether to compress serialized RDD partitions (e.g. for StorageLevel.MEMORY_ONLY_SER). Can save substantial space at the cost of some extra CPU time."},{"keyPattern":"spark\\.speculation","valuePattern":"(true|false)","keyPatternDisplay":"spark.speculation","valuePatternDisplay":"true|false","description":"Whether to use speculation (recommended off for streaming)"},{"keyPattern":"spark\\.es(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"es(\\.([^\\.]+))+","valuePattern":".*","keyPatternDisplay":"es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"spark\\.(storage|shuffle)\\.memoryFraction","valuePattern":"0?\\.0*([1-9])([0-9])*","keyPatternDisplay":"spark.(storage|shuffle).memoryFraction","valuePatternDisplay":"(0.0,1.0)","description":"Fraction of Java heap to use for Spark's shuffle or storage"},{"keyPattern":"spark\\.streaming\\.backpressure\\.enabled","valuePattern":"(true|false)","keyPatternDisplay":"spark.streaming.backpressure.enabled","valuePatternDisplay":"true|false","description":"Enables or disables Spark Streaming's internal backpressure mechanism (since 1.5). This enables the Spark Streaming to control the receiving rate based on the current batch scheduling delays and processing times so that the system receives only as fast as the system can process. Internally, this dynamically sets the maximum receiving rate of receivers. This rate is upper bounded by the values `spark.streaming.receiver.maxRate` and `spark.streaming.kafka.maxRatePerPartition` if they are set."},{"keyPattern":"spark\\.streaming\\.receiver\\.maxRate","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.receiver.maxRate","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which each receiver will receive data. Effectively, each stream will consume at most this number of records per second. Setting this configuration to 0 or a negative number will put no limit on the rate. See the deployment guide in the Spark Streaming programing guide for mode details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRatePerPartition","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRatePerPartition","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which data will be read from each Kafka partition when using the Kafka direct stream API introduced in Spark 1.3. See the Kafka Integration guide for more details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRetries","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRetries","valuePatternDisplay":"numeric","description":"Maximum number of consecutive retries the driver will make in order to find the latest offsets on the leader of each partition (a default value of 1 means that the driver will make a maximum of 2 attempts). Only applies to the Kafka direct stream API introduced in Spark 1.3."},{"keyPattern":"spark\\.streaming\\.ui\\.retainedBatches","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.ui.retainedBatches","valuePatternDisplay":"numeric","description":"How many batches the Spark Streaming UI and status APIs remember before garbage collecting."}],"enableReactNotebookComments":true,"enableResetPassword":true,"enableJobsSparkUpgrade":true,"sparkVersions":[{"key":"1.3.x-ubuntu15.10","displayName":"Spark 1.3.0 (Hadoop 1)","packageLabel":"spark-1.3-jenkins-ip-10-30-10-144-Ua0929df2de-Sa2ee4664b2-2016-03-24-22:00:06.332934","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.4.x-ubuntu15.10","displayName":"Spark 1.4.1 (Hadoop 1)","packageLabel":"spark-1.4-jenkins-ip-10-30-10-144-Ua0929df2de-S9c254ab12a-2016-03-24-22:00:06.332934","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.5.x-ubuntu15.10","displayName":"Spark 1.5.2 (Hadoop 1)","packageLabel":"spark-1.5-jenkins-ip-10-30-10-144-Ua0929df2de-S9ca52d000d-2016-03-24-22:00:06.332934","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.0-ubuntu15.10","displayName":"Spark 1.6.0 (Hadoop 1)","packageLabel":"spark-1.6.0-jenkins-ip-10-30-10-144-Ua0929df2de-Sf90f83597b-2016-03-24-22:00:06.332934","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.1-ubuntu15.10-hadoop1","displayName":"Spark 1.6.1 (Hadoop 1)","packageLabel":"spark-1.6.1-hadoop1-jenkins-ip-10-30-10-144-Ua0929df2de-S91a12bb288-2016-03-24-22:00:06.332934","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.1-ubuntu15.10-hadoop2","displayName":"Spark 1.6.1 (Hadoop 2)","packageLabel":"spark-1.6.1-hadoop2-jenkins-ip-10-30-10-144-Ua0929df2de-S91a12bb288-2016-03-24-22:00:06.332934","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.x-ubuntu15.10","displayName":"Spark 1.6.x (Hadoop 1)","packageLabel":"spark-1.6.1-hadoop1-jenkins-ip-10-30-10-144-Ua0929df2de-S91a12bb288-2016-03-24-22:00:06.332934","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"1.6.x-ubuntu15.10-hadoop1","displayName":"Spark 1.6.x (Hadoop 1)","packageLabel":"spark-1.6.1-hadoop1-jenkins-ip-10-30-10-144-Ua0929df2de-S91a12bb288-2016-03-24-22:00:06.332934","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"1.6.x-ubuntu15.10-hadoop2","displayName":"Spark 1.6.x (Hadoop 2)","packageLabel":"spark-1.6.1-hadoop2-jenkins-ip-10-30-10-144-Ua0929df2de-S91a12bb288-2016-03-24-22:00:06.332934","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"master","displayName":"Spark master (dev)","packageLabel":"","upgradable":true,"deprecated":false,"customerVisible":false}],"enableRestrictedClusterCreation":true,"enableFeedback":true,"defaultNumWorkers":0,"defaultZoneId":"us-west-2c","serverContinuationTimeoutMillis":10000,"driverStderrFilePrefix":"stderr","enableNotebookRefresh":false,"driverStdoutFilePrefix":"stdout","enableSparkDocsSearch":true,"prefetchSidebarNodes":true,"sparkHistoryServerEnabled":true,"sanitizeMarkdownHtml":true,"enableIPythonImportExport":true,"enableNotebookHistoryDiffing":true,"branch":"2.15.2","accountsLimit":3,"enableNotebookGitBranching":true,"local":false,"enableStrongPassword":false,"displayDefaultContainerMemoryGB":6,"devTierHomepageDesign":"featured-notebooks","deploymentMode":"production","useSpotForWorkers":true,"enableUserInviteWorkflow":true,"enableStaticNotebooks":true,"dbcGuideURL":"#workspace/databricks_guide/00 Welcome to Databricks","enableCssTransitions":true,"showHomepageFeaturedLinks":true,"pricingURL":"https://databricks.com/product/pricing","enableClusterAclsConfig":false,"orgId":1849667666963343,"enableNotebookGitVersioning":true,"files":"files/","enableAutoScaledClusterSelection":false,"enableDriverLogsUI":true,"disableLegacyDashboards":true,"enableWorkspaceAclsConfig":false,"dropzoneMaxFileSize":4096,"enableNewDashboardViews":true,"driverLog4jFilePrefix":"log4j","enableMavenLibraries":true,"displayRowLimit":1000,"defaultSparkVersion":{"key":"1.6.0-ubuntu15.10","displayName":"Spark 1.6.0 (Hadoop 1)","packageLabel":"spark-1.6.0-jenkins-ip-10-30-10-144-Ua0929df2de-Sf90f83597b-2016-03-24-22:00:06.332934","upgradable":true,"deprecated":false,"customerVisible":true},"enableMountAclsConfig":false,"clusterPublisherRootId":555452184454234,"enableLatestJobRunResultPermalink":true,"disallowAddingAdmins":true,"enableSparkConfUI":true,"enableOrgSwitcherUI":true,"clustersLimit":1,"enableJdbcImport":true,"logfiles":"logfiles/","enableWebappSharding":false,"enableClusterDeltaUpdates":true,"csrfToken":"65eec25e-3b08-49ec-9277-d245a16fb72f","useFixedStaticNotebookVersionForDevelopment":false,"enableMountAcls":false,"requireEmailUserName":true,"enableDashboardViews":false,"dbcFeedbackURL":"mailto:feedback@databricks.com","enableMountAclService":true,"enableWorkspaceAclService":true,"someName":"César de Pablo Sanchez","enableWorkspaceAcls":false,"gitHash":"a0929df2de56785ff123ca0f02a6f09beb2a953f","showWorkspaceFeaturedLinks":true,"userFullname":"César de Pablo Sanchez","allowFeedbackForumAccess":true,"enableImportFromUrl":true,"enableMiniClusters":true,"enableWebSocketDeltaUpdates":true,"showDevTierBetaVersion":true,"enableDebugUI":false,"showHiddenSparkVersions":false,"allowNonAdminUsers":true,"userId":1701654016298032,"dbcSupportURL":"","staticNotebookResourceUrl":"https://databricks-prod-cloudfront.cloud.databricks.com/static/201603241449160700-a0929df2de56785ff123ca0f02a6f09beb2a953f/","enableSparkPackages":true,"enableHybridClusterType":false,"enableNotebookHistoryUI":true,"availableWorkspaces":[{"name":"Synergic Partners","needsConfirmation":false,"orgId":1849667666963343,"owner":"zesar.depablo@gmail.com"}],"enableFolderHtmlExport":true,"enableSparkVersionsUI":true,"homepageFeaturedLinks":[{"linkURI":"https://docs.cloud.databricks.com/docs/latest/featured_notebooks/1%20QuickStart%20Notebooks%20(Python).html","displayName":"Getting Started","icon":"img/home/Python_icon.svg"},{"linkURI":"https://docs.cloud.databricks.com/docs/latest/featured_notebooks/3%20QuickStart%20DataFrames%20(Scala).html","displayName":"Introduction to DataFrames","icon":"img/home/Scala_icon.svg"},{"linkURI":"https://docs.cloud.databricks.com/docs/latest/featured_notebooks/DecisionTrees-Example.html","displayName":"Decision Trees in Spark","icon":"img/home/Scala_icon.svg"}],"databricksGuideStaticUrl":"https://docs.cloud.databricks.com/docs/latest/databricks_guide","enableHybridClusters":true,"upgradeURL":"https://accounts.cloud.databricks.com/registration.html","clusterManagerAclsEnabled":false,"notebookLoadingBackground":"#fff","enableNewJobRunDetailsPage":true,"user":"zesar.depablo@gmail.com","enableServerAutoComplete":true,"enableStaticHtmlImport":true,"defaultMemoryPerContainerMB":6000,"enablePresenceUI":true,"tablesPublisherRootId":555452184454233,"enableNewInputWidgetUI":false,"accounts":true,"useFramedStaticNotebooks":true,"enableNewProgressReportUI":true,"defaultCoresPerContainer":4};</script>
<script>var __DATABRICKS_NOTEBOOK_MODEL = {"version":"NotebookV1","origId":1026672534565241,"name":"ForestCoverWithDecisionTrees","language":"scala","commands":[{"version":"CommandV1","origId":2059255448682713,"guid":"07c85df1-9025-4bce-889f-9090bbdc966d","subtype":"command","commandType":"auto","position":0.5,"command":"%md # Clasificación de tipos de bosque\n\n**Objetivo** : Demostrar el uso de MLlib en un problema de clasificación. \n\n**Dataset** : El dataset Forest Covtyoe registra el tipo de bosque de diferentes parcelas de terreno (30m x 30m ) en el [Parque Nacional Roosevelt](https://en.wikipedia.org/wiki/Roosevelt_National_Forest) en Colorado, USA. El objetivo de este dataset es poder predecir el tipo de bosque a partir de variables cartográficas de forma que se puedan gestionar los recursos naturales y complementar una catalogación \"manual\" que pueda ser potencialmente costosa. \n\nCada parcela se describe mediante una serie de variables independientes (características): \n  - elevación\n  - pendiente \n  - distancia hasta puntos de agua\n  - sombra\n  - zona (4) \n  - tipo de terreno (40) \n  \nPor último, la variable a predecir es el tipo de bosque que se encuentra en la parcela de los que se catalogan 7 tipos diferentes: \n\n   - 1 Spruce/Fir - (abeto)\n   - 2 Lodgepole Pine \n   - 3 Ponderosa Pine\n   - 4 Cottonwood/Willow (álamo/sauce)\n   - 5 Aspen  (alamo temblón)\n   - 6 Douglas-fir (abeto de Douglas)\n   - 7 Krummholz\n\nhttps://archive.ics.uci.edu/ml/machine-learning-databases/covtype/\n","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"Clasificación de tipos dusando árboles de decisión","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"d138f36e-1981-4eda-9ad2-3c31543552f8"},{"version":"CommandV1","origId":2059255448682714,"guid":"647b5a11-734f-4c30-8f27-294ad4b490ed","subtype":"command","commandType":"auto","position":0.75,"command":"%md ##¿Por que elegimos este problema? \n\n- Problema relativamente sencillo\n- Caractericas principalmente numéricas \n- Características categóricas ya están transformadas - One Hot Encoding\n- Árboles de decision pueden trabajar con las características tal y como se representan\n- Usamos RDDs ","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"2ebf5ebc-6ff4-45ef-8f7d-e795c7a8c575"},{"version":"CommandV1","origId":2059255448682717,"guid":"9ad5e923-973f-40b5-b74f-523945c5f845","subtype":"command","commandType":"auto","position":0.8125,"command":"%md ## ¿Cómo funciona un árbol de decision?\n\nhttp://www.r2d3.us/visual-intro-to-machine-learning-part-1/\n\n\n","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"8921a482-1076-40e6-a954-b6f59cb4c534"},{"version":"CommandV1","origId":2059255448682715,"guid":"ff33e91a-4bea-444a-82cf-c5f2f0fc06a8","subtype":"command","commandType":"auto","position":0.875,"command":"%md ### 1. Carga de datos","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"7af71124-9d1f-421d-af10-65c14913547d"},{"version":"CommandV1","origId":1026672534565243,"guid":"ad3fe7df-b2d7-4707-80e7-a54028354661","subtype":"command","commandType":"auto","position":1.0,"command":"val rawData = sc.textFile(\"/FileStore/tables/nz8hk79k1457221209758/covtype.data\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">rawData: org.apache.spark.rdd.RDD[String] = MapPartitionsRDD[88] at textFile at &lt;console&gt;:28\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.457221908664E12,"submitTime":1.457221907008E12,"finishTime":1.457221908801E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"zesar.depablo@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"914f3893-958e-4b91-bbb9-0e48c1ff373a"},{"version":"CommandV1","origId":1026672534565246,"guid":"d7e687c3-8d2b-45fc-8ebd-8e057aa4f897","subtype":"command","commandType":"auto","position":1.5,"command":"rawData.first","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res0: String = 2596,51,3,258,0,510,221,232,148,6279,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,5\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.457221928522E12,"submitTime":1.457221926866E12,"finishTime":1.457221929522E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"zesar.depablo@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"b5264c6e-4816-44ae-a9cb-b50391bb675e"},{"version":"CommandV1","origId":2059255448682716,"guid":"e7877d2a-b1cc-4967-a3b5-9553c12e7905","subtype":"command","commandType":"auto","position":1.75,"command":"%md Visualizamos las características y en este caso la variable a predecir es la última","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"7a6af3eb-9a37-4d1b-9093-4eaef5e39450"},{"version":"CommandV1","origId":2059255448682718,"guid":"3e0ab07c-0eef-4168-ba99-17b9f698d095","subtype":"command","commandType":"auto","position":1.875,"command":"%md ### 2. Transformamos los datos en un RDD de LabeledPoint","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"70acd466-7e0f-45b5-9b73-7061055047b1"},{"version":"CommandV1","origId":1026672534565245,"guid":"0fe23015-7e41-4c65-b3d8-3cad3ca0b7ca","subtype":"command","commandType":"auto","position":2.0,"command":"import org.apache.spark.mllib.linalg._\nimport org.apache.spark.mllib.regression._\n\nval data = rawData.map { line =>\n  val values = line.split(',').map(_.toDouble)\n  val featureVector = Vectors.dense(values.init)\n  val label = values.last - 1\n  LabeledPoint(label, featureVector)\n}","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">import org.apache.spark.mllib.linalg._\nimport org.apache.spark.mllib.regression._\ndata: org.apache.spark.rdd.RDD[org.apache.spark.mllib.regression.LabeledPoint] = MapPartitionsRDD[110] at map at &lt;console&gt;:33\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:32: error: not found: value Vectors\n         val featureVector = Vectors.dense(values.init)\n                             ^\n&lt;console&gt;:34: error: not found: value LabeledPoint\n         LabeledPoint(label, featureVector)\n         ^\n</div>","error":null,"workflows":[],"startTime":1.457222016758E12,"submitTime":1.457222015105E12,"finishTime":1.457222017501E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"zesar.depablo@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"762724ff-f379-4298-bcca-7996ff490f5a"},{"version":"CommandV1","origId":1026672534565247,"guid":"5c262270-5fb8-40aa-9873-7d3654424ccd","subtype":"command","commandType":"auto","position":3.0,"command":"data.first","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res1: org.apache.spark.mllib.regression.LabeledPoint = (4.0,[2596.0,51.0,3.0,258.0,0.0,510.0,221.0,232.0,148.0,6279.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.45722210759E12,"submitTime":1.457222105933E12,"finishTime":1.457222108236E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"zesar.depablo@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"d6519f40-07bf-4059-ad28-421625c9c2b5"},{"version":"CommandV1","origId":2059255448682719,"guid":"d3eb2c29-27b7-40d7-b452-469a764f2b06","subtype":"command","commandType":"auto","position":3.5,"command":"%md ### 3. Dividimos los datos en conjunto de entrenamiento, test y validación.\n- Puesto que no se trata de un conjunto de datos masivo podemos cachearlos en memoria - generalmente no lo haríamos. ","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"38aad162-b1ad-4ca6-8c4a-1822be6320b0"},{"version":"CommandV1","origId":1026672534565248,"guid":"f20e39af-6b78-4b67-8852-49d6cccb2205","subtype":"command","commandType":"auto","position":4.0,"command":"val Array(trainData, cvData, testData) = data.randomSplit(Array(0.8, 0.1, 0.1))\n\ntrainData.cache()\ncvData.cache()\ntestData.cache()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">trainData: org.apache.spark.rdd.RDD[org.apache.spark.mllib.regression.LabeledPoint] = MapPartitionsRDD[147] at randomSplit at &lt;console&gt;:38\ncvData: org.apache.spark.rdd.RDD[org.apache.spark.mllib.regression.LabeledPoint] = MapPartitionsRDD[148] at randomSplit at &lt;console&gt;:38\ntestData: org.apache.spark.rdd.RDD[org.apache.spark.mllib.regression.LabeledPoint] = MapPartitionsRDD[149] at randomSplit at &lt;console&gt;:38\nres2: testData.type = MapPartitionsRDD[149] at randomSplit at &lt;console&gt;:38\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.457222301051E12,"submitTime":1.457222299394E12,"finishTime":1.457222301693E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"zesar.depablo@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"8a28790e-5b08-4c8f-8b65-9da4b40900fd"},{"version":"CommandV1","origId":1026672534565249,"guid":"d56f0379-d58b-4792-9670-a7688afe3ae4","subtype":"command","commandType":"auto","position":5.0,"command":"trainData.count()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res5: Long = 464652\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.457222417102E12,"submitTime":1.45722241545E12,"finishTime":1.457222417272E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"zesar.depablo@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"6424ca58-8e33-4743-939a-4425837254e8"},{"version":"CommandV1","origId":1026672534565250,"guid":"4d7a3374-a212-4f75-8992-7a1dafeeab81","subtype":"command","commandType":"auto","position":6.0,"command":"cvData.count()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res6: Long = 58151\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.457222426104E12,"submitTime":1.457222424449E12,"finishTime":1.457222426247E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"zesar.depablo@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"caa1f2f5-6391-4347-9a3e-f5188e924edb"},{"version":"CommandV1","origId":1026672534565251,"guid":"94c3542e-8253-42cc-8e7f-13db15a1d3c5","subtype":"command","commandType":"auto","position":7.0,"command":"testData.count()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res7: Long = 58209\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.457222431731E12,"submitTime":1.457222430074E12,"finishTime":1.457222431858E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"zesar.depablo@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"fb19e0c9-c63f-4973-949c-9317d526ec8e"},{"version":"CommandV1","origId":2059255448682720,"guid":"12599d1b-4bca-4b10-9502-5e94c49851a3","subtype":"command","commandType":"auto","position":7.5,"command":"%md ### 4. Entrenamos el modelo usando un Árbol de decisión","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"62c8967f-8285-447c-99cb-220e1b79d865"},{"version":"CommandV1","origId":1026672534565252,"guid":"06bc67a9-bd91-441e-bddd-2792b38d354a","subtype":"command","commandType":"auto","position":8.0,"command":"import org.apache.spark.mllib.tree._\nimport org.apache.spark.mllib.tree.model._\n\nval model = DecisionTree.trainClassifier(trainData, 7, Map[Int,Int](), \"gini\", 4, 100)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">import org.apache.spark.mllib.tree._\nimport org.apache.spark.mllib.tree.model._\nmodel: org.apache.spark.mllib.tree.model.DecisionTreeModel = DecisionTreeModel classifier of depth 4 with 31 nodes\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:34: error: not found: value DecisionTree\n       val model = DecisionTree.trainClassifier(trainData, 7, Map[Int,Int](), &quot;gini&quot;, 4, 100)\n                   ^\n</div>","error":null,"workflows":[],"startTime":1.457222571827E12,"submitTime":1.457222570168E12,"finishTime":1.457222574293E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"zesar.depablo@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"3fd9a614-d570-4134-acee-34bc13a8854c"},{"version":"CommandV1","origId":2059255448682721,"guid":"50abba75-237f-47fa-a652-1a1e1b815a8a","subtype":"command","commandType":"auto","position":8.5,"command":"%md \n\n- Numero de clases: 7 \n- Map[Int,Int]() - ignorar de momento, mapeo de las variables categóricas\n- Método para elegir la partición de los nodos: gini \n- Máxima profundidad: 4\n- Máximo número de bins a usar en las variables continuas: 100 \n","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"eb0bbb85-c5cd-4c0e-bfb4-18885e9de17f"},{"version":"CommandV1","origId":2059255448682722,"guid":"914833ee-6738-4050-8b1d-7c0bf0aecc1c","subtype":"command","commandType":"auto","position":8.75,"command":"%md ### 5. Predicción con el modelo entrenado","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"f99df470-5845-4660-a603-c689ace87a22"},{"version":"CommandV1","origId":1026672534565253,"guid":"c5e2cf96-d2a1-4ca2-90a0-055a61a7a127","subtype":"command","commandType":"auto","position":9.0,"command":"val predictions = cvData.map(x => model.predict(x.features))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">predictions: org.apache.spark.rdd.RDD[Double] = MapPartitionsRDD[299] at map at &lt;console&gt;:44\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:46: error: not found: value predict\n              cvData.map(x =&gt; predict(model,x.features)).first\n                              ^\n</div>","error":null,"workflows":[],"startTime":1.457223365365E12,"submitTime":1.45722336371E12,"finishTime":1.457223365539E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"zesar.depablo@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"6ce5c505-96dc-461f-becd-6be66e99030f"},{"version":"CommandV1","origId":1026672534565254,"guid":"e80441ed-fa0d-48f5-b85f-7132c495bd26","subtype":"command","commandType":"auto","position":10.0,"command":"predictions.take(10)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res15: Array[Double] = Array(1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.0, 0.0, 1.0, 1.0)\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.457223419537E12,"submitTime":1.457223417886E12,"finishTime":1.457223419664E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"zesar.depablo@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"3e8f3642-bc39-4c1f-900e-0b8d6c224172"},{"version":"CommandV1","origId":1026672534565255,"guid":"00db66c9-cce1-4dac-b74d-a96b5bf70309","subtype":"command","commandType":"auto","position":11.0,"command":"val predictionsAndLabels = cvData.map(example => (model.predict(example.features), example.label) )","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">predictionsAndLabels: org.apache.spark.rdd.RDD[(Double, Double)] = MapPartitionsRDD[325] at map at &lt;console&gt;:44\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.457223506748E12,"submitTime":1.457223505101E12,"finishTime":1.457223506885E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"zesar.depablo@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"1673290e-f4bc-4966-9f4c-48166e1739bd"},{"version":"CommandV1","origId":1026672534565256,"guid":"5bbe54f7-f341-4467-876f-d811a705db50","subtype":"command","commandType":"auto","position":12.0,"command":"predictionsAndLabels.take(10).foreach(println)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">(1.0,1.0)\n(1.0,4.0)\n(1.0,4.0)\n(1.0,0.0)\n(1.0,4.0)\n(1.0,1.0)\n(0.0,1.0)\n(0.0,1.0)\n(1.0,1.0)\n(1.0,1.0)\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.457223567077E12,"submitTime":1.457223565423E12,"finishTime":1.457223567258E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"zesar.depablo@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"a90f89ce-3c0a-415a-bbca-cf7480ba61f9"},{"version":"CommandV1","origId":2059255448682724,"guid":"bb0f28aa-d53f-4bb8-ab32-9db04a5df6a0","subtype":"command","commandType":"auto","position":12.5,"command":"%md ### 6. Definimos una función de evaluación","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"a6a5eb37-55a1-4953-9276-59592022c453"},{"version":"CommandV1","origId":1026672534565257,"guid":"32245eb8-96b0-4468-a33c-ee8953b556ee","subtype":"command","commandType":"auto","position":13.0,"command":"import org.apache.spark.mllib.evaluation._\n\ndef getMetrics(model: DecisionTreeModel, data: RDD[LabeledPoint]): MulticlassMetrics = {\n  val predictionsAndLabels = data.map(example => (model.predict(example.features), example.label) )\n  \n  new MulticlassMetrics(predictionsAndLabels)\n}","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">import org.apache.spark.mllib.evaluation._\ngetMetrics: (model: org.apache.spark.mllib.tree.model.DecisionTreeModel, data: org.apache.spark.rdd.RDD[org.apache.spark.mllib.regression.LabeledPoint])org.apache.spark.mllib.evaluation.MulticlassMetrics\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:52: error: not found: type MulticlassMetrics\n       def getMetrics(model: DecisionTreeModel, data: RDD[LabeledPoint]): MulticlassMetrics = {\n                                                                          ^\n&lt;console&gt;:55: error: not found: type MulticlassMetrics\n         new MulticlassMetrics(predictionsAndLabels)\n             ^\n</div>","error":null,"workflows":[],"startTime":1.457223654308E12,"submitTime":1.457223652655E12,"finishTime":1.457223654422E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"zesar.depablo@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"72620aa1-e817-4012-ad47-22713c0720d7"},{"version":"CommandV1","origId":1026672534565258,"guid":"7050161d-44e3-471d-bc97-ee4c155b9bc0","subtype":"command","commandType":"auto","position":14.0,"command":"val metrics = getMetrics(model, cvData)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">metrics: org.apache.spark.mllib.evaluation.MulticlassMetrics = org.apache.spark.mllib.evaluation.MulticlassMetrics@1ba8b7d1\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.457223676442E12,"submitTime":1.457223674785E12,"finishTime":1.457223676617E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"zesar.depablo@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"c1730552-f527-4fbb-b9e6-34f0371b80cd"},{"version":"CommandV1","origId":1026672534565260,"guid":"ccdaff59-07d0-47a6-9bed-50b8645da031","subtype":"command","commandType":"auto","position":16.0,"command":"println(\"Confusion matrix:\")\nprintln(metrics.confusionMatrix)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Confusion matrix:\n14278.0  6595.0   5.0     0.0    0.0  1.0   327.0  \n5701.0   22243.0  383.0   22.0   0.0  9.0   40.0   \n0.0      428.0    3023.0  70.0   0.0  10.0  0.0    \n0.0      0.0      160.0   106.0  0.0  0.0   0.0    \n0.0      914.0    28.0    1.0    0.0  0.0   0.0    \n0.0      493.0    1212.0  24.0   0.0  49.0  0.0    \n1146.0   20.0     0.0     0.0    0.0  0.0   863.0  \n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.457223834563E12,"submitTime":1.457223832911E12,"finishTime":1.457223834653E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"zesar.depablo@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"8120acf1-f47b-4017-b60b-3b64e05e73e8"},{"version":"CommandV1","origId":1026672534565263,"guid":"c51785fd-8257-4fbf-9a0f-3663837e19ec","subtype":"command","commandType":"auto","position":16.5,"command":"val precision = metrics.precision\nval recall = metrics.recall // same as true positive rate\nval f1Score = metrics.fMeasure","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">precision: Double = 0.6975288473113103\nrecall: Double = 0.6975288473113103\nf1Score: Double = 0.6975288473113103\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.457223936206E12,"submitTime":1.457223934558E12,"finishTime":1.457223936307E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"zesar.depablo@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"d7664456-5690-4f4d-a862-046495ada1a9"},{"version":"CommandV1","origId":1026672534565261,"guid":"7e854f80-b2f5-4555-b10e-f65fe9c9ab7f","subtype":"command","commandType":"auto","position":17.0,"command":"println(\"Summary Statistics\")\nprintln(s\"Precision = $precision\")\nprintln(s\"Recall = $recall\")\nprintln(s\"F1 Score = $f1Score\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Summary Statistics\nPrecision = 0.6975288473113103\nRecall = 0.6975288473113103\nF1 Score = 0.6975288473113103\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.457224010838E12,"submitTime":1.457224009194E12,"finishTime":1.457224010931E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"zesar.depablo@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"9167741c-ba05-403e-80f6-e85578feeb0d"},{"version":"CommandV1","origId":1026672534565264,"guid":"2591643a-3ef4-4bdc-9ab9-1726cd499597","subtype":"command","commandType":"auto","position":19.0,"command":"(0 until 7).map(\ncat => (cat, metrics.precision(cat), metrics.recall(cat))\n).foreach(println)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">(0,0.6758816568047338,0.673300009431293)\n(1,0.7246929267259635,0.7832593844636946)\n(2,0.6283516940345043,0.8561314075332767)\n(3,0.47533632286995514,0.39849624060150374)\n(4,0.0,0.0)\n(5,0.7101449275362319,0.027559055118110236)\n(6,0.7016260162601626,0.42533267619517)\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:62: error: missing parameter type for expanded function ((x$1) =&gt; scala.Tuple3(x$1, metrics.precision(cat), metrics.recall(cat)))\n              cat =&gt; (_, metrics.precision(cat), metrics.recall(cat))\n                      ^\n</div>","error":null,"workflows":[],"startTime":1.457224118886E12,"submitTime":1.457224117241E12,"finishTime":1.457224119034E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"zesar.depablo@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"54817fa6-40c0-43fe-90ab-4f5bb0eaa87f"},{"version":"CommandV1","origId":2059255448682725,"guid":"3147e2b9-d1b5-49d8-a8d7-7303cf57f821","subtype":"command","commandType":"auto","position":19.5,"command":"%md 7. ¿Es útil? Mejora respecto al modelo trivial","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"aec60824-9c8c-4448-878b-5c8cd4ecc866"},{"version":"CommandV1","origId":1026672534565265,"guid":"05ca9956-a885-4a18-ba64-f0ff9a41af2e","subtype":"command","commandType":"auto","position":20.0,"command":"def classProbabilities(data: RDD[LabeledPoint]): Array[Double] = {\n \n  val countsByCategory = data.map(_.label).countByValue()\n  val counts = countsByCategory.toArray.sortBy(_._1).map(_._2) \n  \n counts.map(_.toDouble / counts.sum)\n}","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">classProbabilities: (data: org.apache.spark.rdd.RDD[org.apache.spark.mllib.regression.LabeledPoint])Array[Double]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.457224412867E12,"submitTime":1.457224411224E12,"finishTime":1.457224413025E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"zesar.depablo@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"4e01bc9b-f1c4-4d42-b95f-622baf36da13"},{"version":"CommandV1","origId":1026672534565266,"guid":"5875d8cb-7b8e-485e-a64d-85f1ecb813e5","subtype":"command","commandType":"auto","position":21.0,"command":"val trainPriorProbabilities = classProbabilities(trainData)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">trainPriorProbabilities: Array[Double] = Array(0.3644340280467963, 0.48723345643621463, 0.061831219923727865, 0.004741182648519753, 0.016388609109613216, 0.02995790397975259, 0.035413599855375635)\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.457224434062E12,"submitTime":1.457224432418E12,"finishTime":1.457224434262E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"zesar.depablo@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"944056f4-c081-4b34-a5f9-e907305136cb"},{"version":"CommandV1","origId":1026672534565267,"guid":"f99d01f1-5318-43d2-976d-0abb5286ccfd","subtype":"command","commandType":"auto","position":22.0,"command":"val cvPriorProbabilities = classProbabilities(cvData)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">cvPriorProbabilities: Array[Double] = Array(0.36467128682223865, 0.48834929751852935, 0.06072122577427731, 0.0045742979484445665, 0.01621640212550085, 0.030575570497497893, 0.03489191931351138)\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.457224582488E12,"submitTime":1.457224580843E12,"finishTime":1.457224582616E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"zesar.depablo@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"d78858d0-be22-4899-94f3-8616559213ad"},{"version":"CommandV1","origId":1026672534565268,"guid":"fec74ddf-2493-4f96-8da2-221d187c9e70","subtype":"command","commandType":"auto","position":23.0,"command":"trainPriorProbabilities.zip(cvPriorProbabilities).map {\n   case (trainProb, cvProb) => trainProb * cvProb\n}.sum","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res33: Double = 0.37703228994418153\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.457224705374E12,"submitTime":1.457224703724E12,"finishTime":1.457224705567E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"zesar.depablo@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"4859fa6b-1634-4ac5-a9a1-8ba2b2143eac"},{"version":"CommandV1","origId":2059255448682726,"guid":"f2b8d096-bebf-4284-bc28-62387aaa6903","subtype":"command","commandType":"auto","position":23.5,"command":"%md 8. Probamos diferentes hyperparámetros","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"573c3f36-e3dd-4c40-94f5-b412a58f65a3"},{"version":"CommandV1","origId":1026672534565269,"guid":"0d26e519-ad04-44ca-8782-2191c819ffa8","subtype":"command","commandType":"auto","position":24.0,"command":"val evaluations = for (\n  impurity <- Array(\"gini\", \"entropy\");\n  depth <- Array(1, 20);\n  bins <- Array(10,300)\n) yield {\n  \n   val model = DecisionTree.trainClassifier( trainData, 7, Map[Int,Int](), impurity, depth, bins)\n   val predictionsAndLabels = cvData.map(example => (model.predict(example.features), example.label))\n   val accuracy = new MulticlassMetrics(predictionsAndLabels).precision\n  \n  ((impurity, depth, bins), accuracy)\n}","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">evaluations: Array[((String, Int, Int), Double)] = Array(((gini,1,10),0.6330071709858816), ((gini,1,300),0.6323021100239032), ((gini,20,10),0.8884455985279703), ((gini,20,300),0.9037333837767192), ((entropy,1,10),0.48834929751852935), ((entropy,1,300),0.48834929751852935), ((entropy,20,10),0.8964248250245052), ((entropy,20,300),0.9129163728912658))\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:52: error: value map is not a member of Int\n         bins &lt;- 100\n                 ^\n&lt;console&gt;:51: error: type mismatch;\n found   : Array[Nothing]\n required: scala.collection.GenTraversableOnce[?]\n         depth &lt;- Array(1, 20);\n               ^\n</div>","error":null,"workflows":[],"startTime":1.457225475042E12,"submitTime":1.457225473401E12,"finishTime":1.457225559528E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"zesar.depablo@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"e9f96422-b773-49b5-9bbe-273db3ce6519"},{"version":"CommandV1","origId":1026672534565270,"guid":"dba92a74-fc9b-4349-9371-2fd32d9fdc6c","subtype":"command","commandType":"auto","position":25.0,"command":"evaluations.sortBy(_._2).reverse.foreach(println)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">((entropy,20,300),0.9129163728912658)\n((gini,20,300),0.9037333837767192)\n((entropy,20,10),0.8964248250245052)\n((gini,20,10),0.8884455985279703)\n((gini,1,10),0.6330071709858816)\n((gini,1,300),0.6323021100239032)\n((entropy,1,300),0.48834929751852935)\n((entropy,1,10),0.48834929751852935)\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.457226451281E12,"submitTime":1.457226449636E12,"finishTime":1.457226451469E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"zesar.depablo@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"2083f72f-d3dd-494c-a96b-ec3c21e52a97"},{"version":"CommandV1","origId":2059255448682727,"guid":"28f8fc9c-a1ea-411b-baee-e11796e4c31f","subtype":"command","commandType":"auto","position":25.5,"command":"%md En este caso, el parámetro de la profundidad de los árboles es decisivo para encontrar un buen clasificador","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"7ccbe9c3-679b-4e71-8f03-37f24c59910e"},{"version":"CommandV1","origId":1026672534565271,"guid":"84c16f21-0463-4d64-9d90-19bfbbefe1ab","subtype":"command","commandType":"auto","position":26.0,"command":"val bestModel = DecisionTree.trainClassifier(trainData, 7, Map[Int,Int](), \"entropy\", 20, 300)\nval testMetrics = getMetrics(bestModel, cvData)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">bestModel: org.apache.spark.mllib.tree.model.DecisionTreeModel = DecisionTreeModel classifier of depth 20 with 28633 nodes\ntestMetrics: org.apache.spark.mllib.evaluation.MulticlassMetrics = org.apache.spark.mllib.evaluation.MulticlassMetrics@8df1ab2\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.457226471289E12,"submitTime":1.457226469615E12,"finishTime":1.457226502173E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"zesar.depablo@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"910b01e5-2e1f-4792-91a8-169eee6e37ba"},{"version":"CommandV1","origId":1026672534565272,"guid":"7da29199-717e-4bc3-b861-cc028dfa1de0","subtype":"command","commandType":"auto","position":27.0,"command":"val precision = testMetrics.precision\nval recall = testMetrics.recall // same as true positive rate\nval f1Score = testMetrics.fMeasure","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">precision: Double = 0.9104916510464136\nrecall: Double = 0.9104916510464136\nf1Score: Double = 0.9104916510464136\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.457226538019E12,"submitTime":1.457226536377E12,"finishTime":1.457226538465E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"zesar.depablo@gmail.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"8331ae7d-4fbc-4e20-826a-b2962d99d91b"}],"dashboards":[],"guid":"00d97fc7-a051-41d0-91a2-4e7df1c956ab","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}};</script>
<script
 src="https://databricks-prod-cloudfront.cloud.databricks.com/static/201603241449160700-a0929df2de56785ff123ca0f02a6f09beb2a953f/js/notebook-main.js"
 onerror="window.mainJsLoadError = true;"></script>
</head>
<body>
  <script>
if (window.mainJsLoadError) {
  var u = 'https://databricks-prod-cloudfront.cloud.databricks.com/static/201603241449160700-a0929df2de56785ff123ca0f02a6f09beb2a953f/js/notebook-main.js';
  var b = document.getElementsByTagName('body')[0];
  var c = document.createElement('div');
  c.innerHTML = ('<h1>Network Error</h1>' +
    '<p><b>Please check your network connection and try again.</b></p>' +
    '<p>Could not load a required resource: ' + u + '</p>');
  c.style.margin = '30px';
  c.style.padding = '20px 50px';
  c.style.backgroundColor = '#f5f5f5';
  c.style.borderRadius = '5px';
  b.appendChild(c);
}
</script>
</body>
</html>
